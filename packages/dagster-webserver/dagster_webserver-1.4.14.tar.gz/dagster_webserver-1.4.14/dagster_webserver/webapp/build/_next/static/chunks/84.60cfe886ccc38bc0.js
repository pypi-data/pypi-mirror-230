"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[84],{23084:function(e,n,t){t.r(n),t.d(n,{RunRoot:function(){return eM},default:function(){return eW}});var i=t(73235),r=t(52322),o=t(40794),s=t(60138),l=t(2736),a=t(62540),c=t(19369),u=t(94901),d=t(42033),p=t(45),h=t(2784),x=t(7267),f=t(48608),m=t(28292),g=t(82550),v=t(17577),j=t(87323),y=t(4804),w=t(88528),S=t(47933),b=t(50292),_=new Intl.Collator(navigator.language,{sensitivity:"base"}),I=function(e){var n=e.assetKeys,t=e.evaluationId,i=h.useMemo(function(){return(0,g._)(n).sort(function(e,n){return _.compare(e.path.join("/"),n.path.join("/"))})},[n]);return(0,r.jsx)(v.J,{placement:"bottom",content:(0,r.jsxs)("div",{style:{width:"340px"},children:[(0,r.jsx)(l.x,{padding:{vertical:8,horizontal:12},border:{side:"bottom",width:1,color:j.w.KeylineGray},style:{fontWeight:600},children:"Auto-materialized"}),(0,r.jsx)(l.x,{flex:{direction:"column",gap:12},padding:{vertical:12},style:{maxHeight:"220px",overflowY:"auto"},children:i.map(function(e){var n=(0,b.p)(e,{view:"auto-materialize-history",evaluation:t});return(0,r.jsxs)(l.x,{padding:{vertical:8,left:12,right:16},flex:{direction:"row",justifyContent:"space-between",alignItems:"center",gap:8},style:{overflow:"hidden"},children:[(0,r.jsxs)(l.x,{flex:{direction:"row",alignItems:"center",gap:8},style:{overflow:"hidden"},children:[(0,r.jsx)(y.JO,{name:"asset"}),(0,r.jsx)(w.g,{text:e.path.join("/")})]}),(0,r.jsx)(S.rU,{to:n,style:{whiteSpace:"nowrap"},children:"View evaluation"})]},n)})})]}),interactionKind:"hover",children:(0,r.jsx)(d.V,{icon:"auto_materialize_policy",children:"Auto-materialized"})})},C=t(34503),O=t(24651),N=t(33667),T=t(61018),R=t(19041),k=t(72037),F=t(85333),L=t(6692),K=t(58467),E=t(49363),J=t(8504),A=t(35505),z=t(8848),D=t(33467),V=t(14590),P=t(1258),U=t(5500),Q=t(7334),q=function(e){h.useEffect(function(){var n=document.querySelector('link[rel="icon"][type="image/svg+xml"]');if(n){var t=n.getAttribute("href");return n.setAttribute("href",e),function(){t&&n.setAttribute("href",t)}}},[e])},M=t(76358),W=t(52427),B=t(3553),G=t(43576),H=t(13729),Z=t(71135),Y=t(97741),$=t(77959),X=t(37416),ee=t(50027),en=t(29330),et=t(79062),ei=t(52024);function er(){var e=(0,i._)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n"]);return er=function(){return e},e}var eo=function(e){switch(e){case Q.VOA.FAILURE:return"/favicon-run-failed.svg";case Q.VOA.SUCCESS:return"/favicon-run-success.svg";case Q.VOA.STARTING:case Q.VOA.STARTED:case Q.VOA.CANCELING:return"/favicon-run-pending.svg";default:return"/favicon.svg"}},es=function(e){var n=e.run,t=e.runId,i=(0,K._)((0,ei.Bz)(),2),o=i[0],s=i[1],l=(0,K._)((0,M.q)({queryKey:"selection",defaults:{selection:""}}),2),a=l[0],c=l[1];q(n?eo(n.status):"/favicon.svg"),(0,C.j)(n?"".concat((0,m.pv)(n.pipelineName)?"":n.pipelineName," ").concat(t.slice(0,8)," [").concat(n.status,"]"):"Run: ".concat(t));var u=function(e,n){var t=n.find(function(n){return"ExecutionStepFailureEvent"===n.__typename&&n.stepKey===e});t&&(0,z._)({body:(0,r.jsx)(V.T9,{error:t})})},d=function(e){c(e),s((0,L._)((0,F._)({},o),{logQuery:"*"!==e?[{token:"query",value:e}]:[]}))};return(0,r.jsx)(X.A.Provider,{value:n,children:(0,r.jsx)(H.C,{runId:t,children:function(e){return(0,r.jsx)(ee.jp,{logs:e,children:function(i){return(0,r.jsx)(ea,{run:n,runId:t,logs:e,logsFilter:o,metadata:i,selectionQuery:a,onSetLogsFilter:s,onSetSelectionQuery:d,onShowStateDetails:u})}})}},t)})},el=function(e){switch(e){case"stdout":return Y.hi.stdout;case"stderr":return Y.hi.stderr;default:return Y.hi.structured}},ea=function(e){var n=e.run,t=e.runId,i=e.logs,o=e.logsFilter,s=e.metadata,a=e.selectionQuery,c=e.onSetLogsFilter,u=e.onSetSelectionQuery,d=(0,et.W)(n),x=h.createRef(),f=(0,K._)((0,M.q)({queryKey:"logType",defaults:{logType:Y.hi.structured}}),2),m=f[0],v=f[1],j=el(m),y=(0,K._)(h.useState(null),2),w=y[0],S=y[1],b=JSON.stringify(Object.keys(s.steps).sort()),_=h.useMemo(function(){return JSON.parse(b)},[b]),I=(null==n?void 0:n.executionPlan)&&(0,U.J)(null==n?void 0:n.executionPlan,s.steps),C=h.useMemo(function(){return I&&a&&"*"!==a?(0,D.V)(I,a).all.map(function(e){return e.name}):[]},[I,a]),O=(0,W.a)(),N=(0,en.r)({stepKeys:_,selectionStepKeys:C,metadata:s,defaultToFirstStep:!1}),T=N.logCaptureInfo,R=N.computeLogFileKey,k=N.setComputeLogFileKey,F=I?o.logQuery.filter(function(e){return e.token&&"query"===e.token}).reduce(function(e,n){return(0,g._)(e).concat((0,g._)((0,D.V)(I,n.value).all.map(function(e){return e.name})))},[]):[];return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(J.OS,{ref:x,axis:"vertical",identifier:"run-gantt",firstInitialPercent:35,firstMinSize:56,first:n?"QUEUED"===n.status?(0,r.jsx)(P.Fu,{run:n}):n.executionPlan&&I?(0,r.jsx)(E.S,{region:"gantt chart",children:(0,r.jsx)(P.hj,{options:{mode:P.hS.WATERFALL_TIMED},toolbarActions:(0,r.jsxs)(l.x,{flex:{direction:"row",alignItems:"center",gap:12},children:[(0,r.jsx)(J.jo,{axis:"vertical",container:x}),(0,r.jsx)($.NX,{run:n,onLaunch:d,graph:I,metadata:s,selection:{query:a,keys:C}})]}),runId:t,graph:I,metadata:s,selection:{query:a,keys:C},onClickStep:function(e,n){var t,i=C.indexOf(e),r='"'.concat(e,'"');if(n.shiftKey)t=(0,g._)(C.map(function(e){return a.includes('"'.concat(e,'"'))?'"'.concat(e,'"'):e})),-1!==i?t.splice(i,1):t.push(r);else if(1===C.length&&-1!==i)t=[];else{t=[r];var o=(0,en.c)(s.logCaptureSteps,e);o&&k(o)}u(t.join(", ")||"*")},onSetSelection:u,focusedTime:o.focusedTime})}):(0,r.jsx)(p.t,{icon:"error",title:"Unable to build execution plan"}):(0,r.jsx)(P.ZW,{runId:t}),second:(0,r.jsx)(E.S,{region:"logs",children:(0,r.jsxs)(ec,{children:[(0,r.jsx)(Y.KZ,{logType:j,onSetLogType:function(e){return v(Y.hi[e])},filter:o,onSetFilter:c,steps:_,metadata:s,computeLogFileKey:R,onSetComputeLogKey:k,computeLogUrl:w,counts:i.counts}),j!==Y.hi.structured?R?O?(0,r.jsx)(B.h,{logKey:R?[t,"compute_logs",R]:[],logCaptureInfo:T,visibleIOType:Y.hi[j],onSetDownloadUrl:S}):(0,r.jsx)(G.K,{runId:t,computeLogFileKey:_.length?R:void 0,ioType:Y.hi[j],setComputeLogUrl:S}):(0,r.jsx)(eu,{type:j}):(0,r.jsx)(Z.S,{logs:i,filter:o,filterStepKeys:F,filterKey:"".concat(JSON.stringify(o)),metadata:s})]})})})})},ec=A.ZP.div.withConfig({componentId:"sc-758bf354-0"})(er()),eu=function(e){var n=e.type;return(0,r.jsx)(l.x,{flex:{direction:"row",grow:1,alignItems:"center",justifyContent:"center"},style:{background:"#221F1B"},children:(0,r.jsx)(p.t,{title:"Select a step to view ".concat(n),icon:"warning",description:"Select a step on the Gantt chart or from the dropdown above to view logs."})})},ed=t(81862),ep=t(87612),eh=t(22970),ex=t(33379),ef=t(92914),em=t(42971),eg=t(70399),ev=t(55829),ej=t(80572),ey=t(88153),ew=t(99200),eS=t(67953),eb=t(85729),e_=t(99339),eI=t(80678),eC=t(78816),eO=t(16369),eN=t(41060),eT=t(4065),eR=t(37842),ek=t(56918),eF=t(83221),eL=t(19200);function eK(){var e=(0,i._)(["\n  flex: 1;\n  overflow: hidden;\n\n  .CodeMirror {\n    height: 100%;\n  }\n"]);return eK=function(){return e},e}var eE=function(e){var n,t,i,o,s=e.run,a=e.isJob,u=s.runConfigYaml,d=(0,eb.gV)().flagInstanceConcurrencyLimits,p=(0,K._)(h.useState(null),2),f=p[0],m=p[1],g=h.useContext(ew.I).rootServerURI,w=h.useContext(eF.Lw).refetch,S=(0,e_.m)(),b=(0,x.k6)(),_=(0,K._)((0,ex.D)(eI.FREE_CONCURRENCY_SLOTS_FOR_RUN_MUTATION),1)[0],I=(n=(0,ed._)(function(){return(0,eh.Jh)(this,function(e){switch(e.label){case 0:return S(u),[4,(0,eS.B7)({intent:"success",icon:"copy_to_clipboard_done",message:"Copied!"})];case 1:return e.sent(),[2]}})}),function(){return n.apply(this,arguments)}),C=(t=(0,ed._)(function(){var e;return(0,eh.Jh)(this,function(n){switch(n.label){case 0:return[4,_({variables:{runId:s.id}})];case 1:if(!(null===(e=n.sent().data)||void 0===e?void 0:e.freeConcurrencySlotsForRun))return[3,3];return[4,(0,eS.B7)({intent:"success",icon:"check_circle",message:"Freed concurrency slots"})];case 2:n.sent(),n.label=3;case 3:return[2]}})}),function(){return t.apply(this,arguments)}),O=(0,eN.$O)({id:s.id,repositoryName:null===(i=s.repositoryOrigin)||void 0===i?void 0:i.repositoryName,repositoryLocationName:null===(o=s.repositoryOrigin)||void 0===o?void 0:o.repositoryLocationName,pipelineName:s.pipelineName,isJob:a});return(0,r.jsxs)("div",{children:[(0,r.jsxs)(ef.Z,{direction:"row",spacing:8,children:[s.hasReExecutePermission?(0,r.jsx)(eO.A,{icon:(0,r.jsx)(y.JO,{name:"edit"}),to:O,children:"Open in Launchpad"}):(0,r.jsx)(em.u,{content:eC.U,useDisabledButtonTooltipFix:!0,children:(0,r.jsx)(eg.zx,{icon:(0,r.jsx)(y.JO,{name:"edit"}),disabled:!0,children:"Open in Launchpad"})}),(0,r.jsx)(eg.zx,{icon:(0,r.jsx)(y.JO,{name:"tag"}),onClick:function(){return m("config")},children:"View tags and config"}),(0,r.jsx)(v.J,{position:"bottom-right",content:(0,r.jsxs)(ev.v2,{children:[(0,r.jsx)(em.u,{content:"Loadable in dagster-webserver-debug",position:"left",targetTagName:"div",children:(0,r.jsx)(ev.sN,{text:"Download debug file",icon:(0,r.jsx)(y.JO,{name:"download_for_offline"}),onClick:function(){return window.open("".concat(g,"/download_debug/").concat(s.id))}})}),d&&s.hasConcurrencyKeySlots&&eR.cv.has(s.status)?(0,r.jsx)(ev.sN,{text:"Free concurrency slots",icon:(0,r.jsx)(y.JO,{name:"lock"}),onClick:C}):null,s.hasDeletePermission?(0,r.jsx)(ev.sN,{icon:"delete",text:"Delete",intent:"danger",onClick:function(){return m("delete")}}):null]}),children:(0,r.jsx)(eg.zx,{icon:(0,r.jsx)(y.JO,{name:"expand_more"})})})]}),(0,r.jsx)(ej.Vq,{isOpen:"config"===f,onClose:function(){return m(null)},style:{width:"90vw",maxWidth:"1000px",minWidth:"600px",height:"90vh",maxHeight:"1000px",minHeight:"600px"},title:"Run configuration",children:(0,r.jsxs)(l.x,{flex:{direction:"column"},style:{flex:1,overflow:"hidden"},children:[(0,r.jsxs)(l.x,{flex:{direction:"column",gap:20},style:{flex:1,overflow:"hidden"},children:[(0,r.jsxs)(l.x,{flex:{direction:"column",gap:12},padding:{top:16,horizontal:24},children:[(0,r.jsx)(c.pm,{children:"Tags"}),(0,r.jsx)("div",{children:(0,r.jsx)(ek.Q,{tags:s.tags,mode:a?null:s.mode})})]}),(0,r.jsxs)(l.x,{flex:{direction:"column"},style:{flex:1,overflow:"hidden"},children:[(0,r.jsx)(l.x,{border:{side:"bottom",width:1,color:j.w.KeylineGray},padding:{left:24,bottom:16},children:(0,r.jsx)(c.pm,{children:"Config"})}),(0,r.jsx)(eJ,{children:(0,r.jsx)(ey.u,{value:u,options:{readOnly:!0,lineNumbers:!0,mode:"yaml"},theme:["config-editor"]})})]})]}),(0,r.jsxs)(ej.cN,{topBorder:!0,children:[(0,r.jsx)(eg.zx,{onClick:function(){return I()},intent:"none",children:"Copy config"}),(0,r.jsx)(eg.zx,{onClick:function(){return m(null)},intent:"primary",children:"OK"})]})]})}),s.hasDeletePermission?(0,r.jsx)(eT.N,{isOpen:"delete"===f,onClose:function(){return m(null)},onComplete:function(){s.repositoryOrigin?b.push((0,eN.jT)({repoName:s.repositoryOrigin.repositoryName,repoLocation:s.repositoryOrigin.repositoryLocationName,pipelineName:s.pipelineName,isJob:a,path:"/runs"})):m(null)},onTerminateInstead:function(){return m("terminate")},selectedRuns:(0,ep._)({},s.id,s.canTerminate)}):null,s.hasTerminatePermission?(0,r.jsx)(eL.A,{isOpen:"terminate"===f,onClose:function(){return m(null)},onComplete:function(){w()},selectedRuns:(0,ep._)({},s.id,s.canTerminate)}):null]})},eJ=A.ZP.div.withConfig({componentId:"sc-dc369901-0"})(eK()),eA=t(54095),ez=t(50743),eD=t(29545),eV=t(61893),eP=t(30082),eU=t(48265),eQ=function(e){var n=e.loading,t=e.run;return(0,r.jsxs)(r.Fragment,{children:[(null==t?void 0:t.startTime)?(0,r.jsx)(v.J,{interactionKind:"hover",placement:"bottom",content:(0,r.jsx)(l.x,{padding:16,children:(0,r.jsx)(eU.s9,{run:t,loading:n})}),children:(0,r.jsx)(d.V,{icon:"schedule",children:(0,r.jsx)(eP.v,{timestamp:t.startTime,timeFormat:{showSeconds:!0,showTimezone:!1}})})}):t.updateTime?(0,r.jsx)(d.V,{icon:"schedule",children:(0,r.jsx)(eP.v,{timestamp:t.updateTime,timeFormat:{showSeconds:!0,showTimezone:!1}})}):void 0,(null==t?void 0:t.startTime)&&(null==t?void 0:t.endTime)?(0,r.jsx)(v.J,{interactionKind:"hover",placement:"bottom",content:(0,r.jsx)(l.x,{padding:16,children:(0,r.jsx)(eU.s9,{run:t,loading:n})}),children:(0,r.jsx)(d.V,{icon:"timer",children:(0,r.jsx)("span",{style:{fontVariantNumeric:"tabular-nums"},children:(null==t?void 0:t.startTime)?(0,eV.fv)(((null==t?void 0:t.endTime)*1e3||Date.now())-(null==t?void 0:t.startTime)*1e3):"–"})})}):null]})};function eq(){var e=(0,i._)(["\n  query RunRootQuery($runId: ID!) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        ...RunPageFragment\n      }\n    }\n  }\n\n  ","\n"]);return eq=function(){return e},e}var eM=function(){(0,f.Px)();var e,n=(0,x.UO)().runId;(0,C.j)(n?"Run ".concat(n.slice(0,8)):"Run");var t=(0,o.a)(eG,{variables:{runId:n}}),i=t.data,s=t.loading,p=(null==i?void 0:i.pipelineRunOrError.__typename)==="Run"?i.pipelineRunOrError:null,g=null==p?void 0:p.pipelineSnapshotId,v=(0,R.n)(p),j=(null==v?void 0:v.match)?(0,T.kQ)(v.match.repository.name,v.match.repositoryLocation.name):null,y=h.useMemo(function(){return!!(p&&v&&(0,N.E8)(v.match,p.pipelineName))},[p,v]),w=h.useMemo(function(){return(null==p?void 0:p.tags.find(function(e){return e.key===eD.H.AssetEvaluationID}))||null},[p]);return(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",minWidth:0,width:"100%",height:"100%",overflow:"hidden"},children:[(0,r.jsx)(l.x,{flex:{direction:"row",alignItems:"flex-start"},style:{position:"relative",zIndex:1},children:(0,r.jsx)(a.m,{title:(0,r.jsx)(c.X6,{style:{fontFamily:u.b.monospace,fontSize:"20px"},children:n.slice(0,8)}),tags:p?(0,r.jsxs)(l.x,{flex:{direction:"row",alignItems:"flex-start",gap:12,wrap:"wrap"},children:[(0,r.jsx)(ez.KG,{status:p.status}),(0,m.pv)(p.pipelineName)?null:(0,r.jsxs)(d.V,{icon:"run",children:["Run of"," ",(0,r.jsx)(O.h,{pipelineName:null==p?void 0:p.pipelineName,pipelineHrefContext:j||"repo-unknown",snapshotId:g,size:"small",isJob:y})]}),(0,r.jsx)(k.m,{useTags:!0,assetChecks:p.assetCheckSelection}),(0,r.jsx)(k.h,{useTags:!0,assetKeys:(0,m.pv)(p.pipelineName)?(0,eF.Bo)(p):p.assets.map(function(e){return e.key})}),(0,r.jsx)(eQ,{run:p,loading:s}),w&&(null===(e=p.assetSelection)||void 0===e?void 0:e.length)?(0,r.jsx)(I,{assetKeys:p.assetSelection,evaluationId:w.value}):null]}):null,right:p?(0,r.jsx)(eE,{run:p,isJob:y}):null})}),(0,r.jsx)(eB,{data:i,runId:n})]})},eW=eM,eB=function(e){var n=e.data,t=e.runId;return n&&n.pipelineRunOrError?"Run"!==n.pipelineRunOrError.__typename?(0,r.jsx)(l.x,{padding:{vertical:64},children:(0,r.jsx)(p.t,{icon:"error",title:"No run found",description:"The run with this ID does not exist or has been cleaned up."})}):(0,r.jsx)(es,{run:n.pipelineRunOrError,runId:t}):(0,r.jsx)(es,{run:void 0,runId:t})},eG=(0,s.Ps)(eq(),eA.tQ)},79062:function(e,n,t){t.d(n,{W:function(){return p}});var i=t(81862),r=t(58467),o=t(22970),s=t(33379),l=t(2784),a=t(7267),c=t(30404),u=t(19041),d=t(83221),p=function(e){var n,t=(0,a.k6)(),p=(0,r._)((0,s.D)(d.kO),1)[0],h=(0,u.n)(e);return l.useCallback((n=(0,i._)(function(n){var i,r,s,l;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(!e||!e.pipelineSnapshotId||!h)return[2];i=(0,d.kz)({run:e,style:n,repositoryLocationName:h.match.repositoryLocation.name,repositoryName:h.match.repository.name}),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,p({variables:i})];case 2:return s=o.sent(),(0,d.lF)(e.pipelineName,null===(r=s.data)||void 0===r?void 0:r.launchPipelineReexecution,t,{preserveQuerystring:!0,behavior:"open"}),[3,4];case 3:return l=o.sent(),(0,c.t)(l),[3,4];case 4:return[2]}})}),function(e){return n.apply(this,arguments)}),[t,p,h,e])}}}]);
//# sourceMappingURL=84.60cfe886ccc38bc0.js.map