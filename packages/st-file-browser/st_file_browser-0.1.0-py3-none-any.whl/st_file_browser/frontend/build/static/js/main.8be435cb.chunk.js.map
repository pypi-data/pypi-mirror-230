{"version":3,"sources":["actions.jsx","StFileBrowser.tsx","index.tsx"],"names":["Actions","props","selectedItems","isFolder","icons","nameFilter","canCreateFolder","onCreateFolder","canRenameFile","onRenameFile","canRenameFolder","onRenameFolder","canDeleteFile","onDeleteFile","canDownloadFile","canDeleteFolder","onDeleteFolder","onDownloadFile","canDownloadFolder","onDownloadFolder","canChooseFile","onChooseFile","canChooseFolder","onChooseFolder","actions","length","selectedItemsAction","filter","item","action","_toConsumableArray","Set","actionText","React","createElement","className","Loading","push","key","onClick","href","role","Folder","itemsWithoutKeyDerived","find","keyDerived","Rename","Delete","Download","aria-hidden","defaultProps","StreamlitEventType","noticeStreamlit","event","Streamlit","setComponentValue","FileBrowserNative","_StreamlitComponentBa","_inherits","_super","_createSuper","_this","_classCallCheck","call","args","folderOpenHandler","opts","ajustHeight","folderCloseHandler","fileSelectedHandler","ignore_file_select_event","file","files","path","type","SELECT_FILE","target","deleteFileHandler","fileKey","includes","console","log","DELETE_FILE","remainingFiles","chooseHandler","keys","CHOOSE_FILE","convertFiles","map","modified","update_time","size","noop","Fragment","render","that","_assertThisInitialized","FileBrowser","Object","assign","showActionBar","canFilter","detailRenderer","Icons","FontAwesome","onFolderOpen","onFolderClose","onSelect","actionRenderer","_len","arguments","Array","_key","_objectSpread","show_choose_file","show_delete_file","i","_createClass","value","revoke_step","root","document","getElementById","height","Math","min","clientHeight","scrollHeight","offsetHeight","setFrameHeight","setTimeout","this","StreamlitComponentBase","StreamlitFileBrowserNative","withStreamlitConnection","FileBrowserWrapper","_StreamlitComponentBa2","_super2","_this2","ReactDOM","StrictMode","StFileBrowser"],"mappings":"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","file":"static/js/main.8be435cb.chunk.js","sourcesContent":["import React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nconst Actions = (props) => {\r\n  const {\r\n    selectedItems,\r\n    isFolder,\r\n    icons,\r\n    nameFilter,\r\n\r\n    canCreateFolder,\r\n    onCreateFolder,\r\n\r\n    canRenameFile,\r\n    onRenameFile,\r\n\r\n    canRenameFolder,\r\n    onRenameFolder,\r\n\r\n    canDeleteFile,\r\n    onDeleteFile,\r\n\r\n    canDeleteFolder,\r\n    onDeleteFolder,\r\n\r\n    canDownloadFile,\r\n    onDownloadFile,\r\n\r\n    canDownloadFolder,\r\n    onDownloadFolder,\r\n\r\n    canChooseFile,\r\n    onChooseFile,\r\n\r\n    canChooseFolder,\r\n    onChooseFolder,\r\n  } = props\r\n\r\n  /** @type any */\r\n  let actions = []\r\n\r\n  if (selectedItems.length) {\r\n    // Something is selected. Build custom actions depending on what it is.\r\n    const selectedItemsAction = selectedItems.filter(item => item.action)\r\n    if (selectedItemsAction.length === selectedItems.length && [...new Set(selectedItemsAction)].length === 1) {\r\n      // Selected item has an active action against it. Disable all other actions.\r\n      let actionText\r\n      switch (selectedItemsAction[0].action) {\r\n        case 'delete':\r\n          actionText = 'Deleting ...'\r\n          break\r\n\r\n        case 'rename':\r\n          actionText = 'Renaming ...'\r\n          break\r\n\r\n        default:\r\n          actionText = 'Moving ...'\r\n          break\r\n      }\r\n\r\n      actions = (\r\n        // TODO: Enable plugging in custom spinner.\r\n        <div className=\"item-actions\">\r\n          {icons.Loading} {actionText}\r\n        </div>\r\n      )\r\n    } else {\r\n      if (isFolder && canCreateFolder && !nameFilter) {\r\n        actions.push(\r\n          <li key=\"action-add-folder\">\r\n            <a\r\n              onClick={onCreateFolder}\r\n              href=\"#\"\r\n              role=\"button\"\r\n            >\r\n              {icons.Folder}\r\n              &nbsp;Add Subfolder\r\n            </a>\r\n          </li>\r\n        )\r\n      }\r\n\r\n      const itemsWithoutKeyDerived = selectedItems.find(item => !item.keyDerived)\r\n      if (!itemsWithoutKeyDerived && !isFolder && canRenameFile && selectedItems.length === 1) {\r\n        actions.push(\r\n          <li key=\"action-rename\">\r\n            <a\r\n              onClick={onRenameFile}\r\n              href=\"#\"\r\n              role=\"button\"\r\n            >\r\n              {icons.Rename}\r\n              &nbsp;Rename\r\n            </a>\r\n          </li>\r\n        )\r\n      } else if (!itemsWithoutKeyDerived && isFolder && canRenameFolder) {\r\n        actions.push(\r\n          <li key=\"action-rename\">\r\n            <a\r\n              onClick={onRenameFolder}\r\n              href=\"#\"\r\n              role=\"button\"\r\n            >\r\n              {icons.Rename}\r\n              &nbsp;Rename\r\n            </a>\r\n          </li>\r\n        )\r\n      }\r\n\r\n      if (!itemsWithoutKeyDerived && !isFolder && canDeleteFile) {\r\n        actions.push(\r\n          <li key=\"action-delete\">\r\n            <a\r\n              onClick={onDeleteFile}\r\n              href=\"#\"\r\n              role=\"button\"\r\n            >\r\n              {icons.Delete}\r\n              &nbsp;Delete\r\n            </a>\r\n          </li>\r\n        )\r\n      }\r\n      // else if (!itemsWithoutKeyDerived && isFolder && canDeleteFolder) {\r\n      //   actions.push(\r\n      //     <li key=\"action-delete\">\r\n      //       <a\r\n      //         onClick={onDeleteFolder}\r\n      //         href=\"#\"\r\n      //         role=\"button\"\r\n      //       >\r\n      //         {icons.Delete}\r\n      //         &nbsp;Delete\r\n      //       </a>\r\n      //     </li>\r\n      //   )\r\n      // }\r\n\r\n      if ((!isFolder && canDownloadFile) || (isFolder && canDownloadFolder)) {\r\n        actions.push(\r\n          <li key=\"action-download\">\r\n            <a\r\n              onClick={isFolder ? onDownloadFolder : onDownloadFile}\r\n              href=\"#\"\r\n              role=\"button\"\r\n            >\r\n              {icons.Download}\r\n              &nbsp;Download\r\n            </a>\r\n          </li>\r\n        )\r\n      }\r\n\r\n      if ((!isFolder && canChooseFile) || (isFolder && canChooseFolder)) {\r\n        actions.push(\r\n          <li key=\"action-choose\">\r\n            <a\r\n              onClick={isFolder ? onChooseFolder : onChooseFile}\r\n              href=\"#\"\r\n              role=\"button\"\r\n            >\r\n              <i className=\"fa fa-plus\" aria-hidden=\"true\" />\r\n              &nbsp;Choose\r\n            </a>\r\n          </li>\r\n        )\r\n      }\r\n\r\n      if (actions.length) {\r\n        actions = (<ul className=\"item-actions\">{actions}</ul>)\r\n      } else {\r\n        actions = (<div className=\"item-actions\">&nbsp;</div>)\r\n      }\r\n    }\r\n  } else {\r\n    // Nothing selected: We're in the 'root' folder. Only allowed action is adding a folder.\r\n    if (canCreateFolder && !nameFilter) {\r\n      actions.push(\r\n        <li key=\"action-add-folder\">\r\n          <a\r\n            onClick={onCreateFolder}\r\n            href=\"#\"\r\n            role=\"button\"\r\n          >\r\n            {icons.Folder}\r\n            &nbsp;Add Folder\r\n          </a>\r\n        </li>\r\n      )\r\n    }\r\n\r\n    if (actions.length) {\r\n      actions = (<ul className=\"item-actions\">{actions}</ul>)\r\n    } else {\r\n      actions = (<div className=\"item-actions\">&nbsp;</div>)\r\n    }\r\n  }\r\n\r\n  return actions\r\n}\r\n\r\nActions.propTypes = {\r\n  selectedItems: PropTypes.arrayOf(PropTypes.object),\r\n  isFolder: PropTypes.bool,\r\n  icons: PropTypes.object,\r\n  nameFilter: PropTypes.string,\r\n\r\n  canCreateFolder: PropTypes.bool,\r\n  onCreateFolder: PropTypes.func,\r\n\r\n  canRenameFile: PropTypes.bool,\r\n  onRenameFile: PropTypes.func,\r\n\r\n  canRenameFolder: PropTypes.bool,\r\n  onRenameFolder: PropTypes.func,\r\n\r\n  canDeleteFile: PropTypes.bool,\r\n  onDeleteFile: PropTypes.func,\r\n\r\n  canDeleteFolder: PropTypes.bool,\r\n  onDeleteFolder: PropTypes.func,\r\n\r\n  canDownloadFile: PropTypes.bool,\r\n  onDownloadFile: PropTypes.func,\r\n\r\n  canDownloadFolder: PropTypes.bool,\r\n  onDownloadFolder: PropTypes.func,\r\n\r\n  canChooseFile: PropTypes.bool,\r\n  onChooseFile: PropTypes.func,\r\n\r\n  canChooseFolder: PropTypes.bool,\r\n  onChooseFolder: PropTypes.func,\r\n}\r\n\r\nActions.defaultProps = {\r\n  selectedItems: [],\r\n  isFolder: false,\r\n  icons: {},\r\n  nameFilter: '',\r\n\r\n  canCreateFolder: false,\r\n  onCreateFolder: null,\r\n\r\n  canRenameFile: false,\r\n  onRenameFile: null,\r\n\r\n  canRenameFolder: false,\r\n  onRenameFolder: null,\r\n\r\n  canDeleteFile: false,\r\n  onDeleteFile: null,\r\n\r\n  canDeleteFolder: false,\r\n  onDeleteFolder: null,\r\n\r\n  canDownloadFile: false,\r\n  onDownloadFile: null,\r\n\r\n  canDownloadFolder: false,\r\n  onDownloadFolder: null,\r\n\r\n  canChooseFile: false,\r\n  onChooseFile: null,\r\n\r\n  canChooseFolder: false,\r\n  onChooseFolder: null,\r\n}\r\n\r\nexport default Actions\r\n","import React from \"react\"\r\nimport {\r\n  Streamlit,\r\n  StreamlitComponentBase,\r\n  withStreamlitConnection,\r\n  ComponentProps,\r\n} from \"streamlit-component-lib\"\r\nimport FileBrowser, {\r\n  Icons,\r\n  FileBrowserFile,\r\n  FileBrowserFolder,\r\n} from \"react-keyed-file-browser\"\r\n\r\nimport get from 'lodash.get'\r\nimport IframeResizer from 'iframe-resizer-react'\r\nimport Actions from \"./actions\"\r\nimport \"react-keyed-file-browser/dist/react-keyed-file-browser.css\"\r\nimport \"font-awesome/css/font-awesome.min.css\"\r\n\r\ninterface File {\r\n  path: string\r\n  name?: string\r\n  size?: number\r\n  create_time?: number\r\n  update_time?: number\r\n  access_time?: number\r\n}\r\n\r\nenum StreamlitEventType {\r\n  SELECT_FILE = \"SELECT_FILE\",\r\n  SELECT_FOLDER = \"SELECT_FOLDER\",\r\n  DOWNLOAD = \"DOWNLOAD\",\r\n  DELETE_FILE = \"DELETE_FILE\",\r\n  DELETE_FOLDER = \"DELETE_FOLDER\",\r\n  RENAME_FOLDER = \"RENAME_FOLDER\",\r\n  RENAME_FILE = \"RENAME_FILE\",\r\n  CREATE_FILE = \"CREATE_FILE\",\r\n  CREATE_FOLDER = \"CREATE_FOLDER\",\r\n  MOVE_FILE = \"MOVE_FILE\",\r\n  MOVE_FOLDER = \"MOVE_FOLDER\",\r\n  CHOOSE_FILE = \"CHOOSE_FILE\",\r\n}\r\n\r\ninterface StreamlitEvent {\r\n  type: StreamlitEventType\r\n  target: File | File[]\r\n}\r\n\r\ninterface State {\r\n  numClicks: number\r\n  isFocused: boolean\r\n}\r\n\r\ninterface IArgs {\r\n  files: File[]\r\n  path: string\r\n  show_download_file: boolean\r\n  show_delete_file: boolean\r\n  show_choose_file: boolean\r\n  show_new_folder: boolean\r\n  show_upload_file: boolean\r\n  ignore_file_select_event: boolean\r\n}\r\n\r\nconst noticeStreamlit = (event: StreamlitEvent) =>\r\n  Streamlit.setComponentValue(event)\r\n\r\n  \r\nclass FileBrowserNative extends StreamlitComponentBase<State> {\r\n  private args: IArgs\r\n\r\n  constructor(props: ComponentProps) {\r\n    super(props)\r\n    this.args = props.args\r\n  }\r\n\r\n  ajustHeight(revoke_step?: number) {\r\n    const root = document.getElementById(\"root\")\r\n    if (root) {\r\n      const height = Math.min(\r\n        root.clientHeight,\r\n        root.scrollHeight,\r\n        root.offsetHeight\r\n      )\r\n      Streamlit.setFrameHeight(height - (revoke_step ? revoke_step : 0))\r\n      setTimeout(Streamlit.setFrameHeight, 1)\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.ajustHeight()\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    this.ajustHeight()\r\n  }\r\n\r\n  folderOpenHandler = (opts: FileBrowserFolder) => this.ajustHeight()\r\n  folderCloseHandler = (opts: FileBrowserFolder) => this.ajustHeight()\r\n\r\n  fileSelectedHandler = (opts: FileBrowserFile) => {\r\n    if (!this.args.ignore_file_select_event) {\r\n      const file = this.args.files.find((file) => file.path === opts.key)\r\n      file &&\r\n        noticeStreamlit({ type: StreamlitEventType.SELECT_FILE, target: file })\r\n    }\r\n  }\r\n\r\n  deleteFileHandler = (fileKey: string | string[]) => {\r\n    const files = this.args.files.filter((file) => typeof fileKey === 'string' ? fileKey === file.path : fileKey.includes(file.path))\r\n    console.log(\"deleteFileHandler\", \"key\", fileKey, \"files \", files)\r\n\r\n    files.length &&\r\n      noticeStreamlit({ type: StreamlitEventType.DELETE_FILE, target: files })\r\n\r\n    const remainingFiles = this.args.files.filter((file) => typeof fileKey === 'string' ? fileKey !== file.path : !fileKey.includes(file.path))\r\n    this.args.files = remainingFiles\r\n  }\r\n\r\n  chooseHandler = (keys: string[]) => {\r\n    const files = this.args.files.filter((file) => keys.includes(file.path))\r\n    files.length &&\r\n      noticeStreamlit({ type: StreamlitEventType.CHOOSE_FILE, target: files })\r\n  }\r\n\r\n  convertFiles = (files: File[]): FileBrowserFile[] =>\r\n    files.map((file) => ({\r\n      key: file.path,\r\n      modified: file.update_time || 0,\r\n      size: file.size || 0,\r\n    }))\r\n\r\n  noop = () => <></>\r\n  public render = () => {\r\n    let that = this\r\n    return (\r\n      <div>\r\n        <FileBrowser\r\n          {...this.args}\r\n          showActionBar\r\n          canFilter={true}\r\n          detailRenderer={this.noop}\r\n          icons={Icons.FontAwesome(4)}\r\n          files={this.convertFiles(this.args.files)}\r\n          onFolderOpen={this.folderOpenHandler}\r\n          onFolderClose={this.folderCloseHandler}\r\n          onSelect={this.fileSelectedHandler}\r\n          onDeleteFile={this.deleteFileHandler}\r\n          actionRenderer={(...args: any) => {\r\n            return Actions({\r\n              ...args[0],\r\n              ...{\r\n                canChooseFile: that.args.show_choose_file,\r\n                canDownloadFile: false,\r\n                canDeleteFile: that.args.show_delete_file,\r\n                onChooseFile: (keys: string[]) =>\r\n                  that.chooseHandler(\r\n                    args[0].selectedItems.map((i: any) => i.key)\r\n                  ),\r\n                onDeleteFile: (fileKey: string[]) =>\r\n                  that.deleteFileHandler(\r\n                      args[0].selectedItems.map((i: any) => i.key)\r\n                  ),\r\n              },\r\n            })\r\n          }}\r\n        />\r\n      </div>\r\n    )\r\n  }\r\n}\r\nconst StreamlitFileBrowserNative = withStreamlitConnection(FileBrowserNative)\r\n\r\nclass FileBrowserWrapper extends StreamlitComponentBase<State> {\r\n  private args: IArgs\r\n  \r\n  constructor(props: ComponentProps) {\r\n    super(props)\r\n    this.args = props.args\r\n  }\r\n\r\n  public render(): React.ReactNode {\r\n      return (\r\n        <div>\r\n          <StreamlitFileBrowserNative {...this.props} />\r\n        </div>\r\n      )\r\n  }\r\n}\r\n\r\nexport default withStreamlitConnection(FileBrowserWrapper)\r\n","import React from \"react\"\r\nimport ReactDOM from \"react-dom\"\r\nimport StFileBrowser from \"./StFileBrowser\"\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <StFileBrowser />\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n)\r\n"],"sourceRoot":""}