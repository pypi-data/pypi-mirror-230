"""That is Stylor , a primary tool for HTPy5 module v1.0.1 , it is used to generate css codes for the method `addStyle()` at HTPy5 init file. 

"""
import textwrap

class SP:
    class CSSProperties:
        ALIGN_CONTENT = "align-content"
        ALIGN_ITEMS = "align-items"
        ALIGN_SELF = "align-self"
        ANIMATION = "animation"
        ANIMATION_DELAY = "animation-delay"
        ANIMATION_DIRECTION = "animation-direction"
        ANIMATION_DURATION = "animation-duration"
        ANIMATION_FILL_MODE = "animation-fill-mode"
        ANIMATION_ITERATION_COUNT = "animation-iteration-count"
        ANIMATION_NAME = "animation-name"
        ANIMATION_PLAY_STATE = "animation-play-state"
        ANIMATION_TIMING_FUNCTION = "animation-timing-function"
        BACKFACE_VISIBILITY = "backface-visibility"
        BACKGROUND_ATTACHMENT = "background-attachment"
        BACKGROUND_COLOR = "background-color"
        BACKGROUND_IMAGE = "background-image"
        BACKGROUND_POSITION = "background-position"
        BACKGROUND_REPEAT = "background-repeat"
        BACKGROUND_SIZE = "background-size"
        BORDER = "border"
        BORDER_COLOR = "border-color"
        BORDER_RADIUS = "border-radius"
        BORDER_STYLE = "border-style"
        BORDER_WIDTH = "border-width"
        BOTTOM = "bottom"
        BOX_DECORATION_BREAK = "box-decoration-break"
        BOX_SHADOW = "box-shadow"
        BOX_SIZING = "box-sizing"
        CAPTION_SIDE = "caption-side"
        CLEAR = "clear"
        CLIP = "clip"
        CLIP_PATH = "clip-path"
        COLOR = "color"
        COLUMN_COUNT = "column-count"
        COLUMN_FILL = "column-fill"
        COLUMN_GAP = "column-gap"
        COLUMN_RULE = "column-rule"
        COLUMN_RULE_COLOR = "column-rule-color"
        COLUMN_RULE_STYLE = "column-rule-style"
        COLUMN_RULE_WIDTH = "column-rule-width"
        COLUMN_SPAN = "column-span"
        COLUMN_WIDTH = "column-width"
        COLUMNS = "columns"
        CONTENT = "content"
        COUNTER_INCREMENT = "counter-increment"
        COUNTER_RESET = "counter-reset"
        CUE = "cue"
        CUE_AFTER = "cue-after"
        CUE_BEFORE = "cue-before"
        CURSOR = "cursor"
        DIRECTION = "direction"
        DISPLAY = "display"
        EMPTY_CELLS = "empty-cells"
        FILTER = "filter"
        FLEX = "flex"
        FLEX_BASIS = "flex-basis"
        FLEX_DIRECTION = "flex-direction"
        FLEX_FLOW = "flex-flow"
        FLEX_GROW = "flex-grow"
        FLEX_SHRINK = "flex-shrink"
        FLEX_WRAP = "flex-wrap"
        FLOAT = "float"
        FONT_FAMILY = "font-family"
        FONT_SIZE = "font-size"
        FONT_STYLE = "font-style"
        FONT_VARIANT = "font-variant"
        FONT_WEIGHT = "font-weight"
        GRID = "grid"
        GRID_AREA = "grid-area"
        GRID_AUTO_COLUMNS = "grid-auto-columns"
        GRID_AUTO_FLOW = "grid-auto-flow"
        GRID_AUTO_ROWS = "grid-auto-rows"
        GRID_COLUMN = "grid-column"
        GRID_COLUMN_END = "grid-column-end"
        GRID_COLUMN_GAP = "grid-column-gap"
        GRID_COLUMN_START = "grid-column-start"
        GRID_GAP = "grid-gap"
        GRID_ROW = "grid-row"
        GRID_ROW_END = "grid-row-end"
        GRID_ROW_GAP = "grid-row-gap"
        GRID_ROW_START = "grid-row-start"
        GRID_TEMPLATE = "grid-template"
        GRID_TEMPLATE_AREAS = "grid-template-areas"
        GRID_TEMPLATE_COLUMNS = "grid-template-columns"
        GRID_TEMPLATE_ROWS = "grid-template-rows"
        HANGING_PUNCTUATION = "hanging-punctuation"
        HEIGHT = "height"
        HYPHENS = "hyphens"
        IMAGE_RENDERING = "image-rendering"
        IMAGE_RESOLUTION = "image-resolution"
        ISOLATION = "isolation"
        JUSTIFY_CONTENT = "justify-content"
        JUSTIFY_ITEMS = "justify-items"
        JUSTIFY_SELF = "justify-self"
        LEFT = "left"
        LETTER_SPACING = "letter-spacing"
        LINE_HEIGHT = "line-height"
        LIST_STYLE = "list-style"
        MARGIN = "margin"
        MARGIN_BOTTOM = "margin-bottom"
        MARGIN_LEFT = "margin-left"
        MARGIN_RIGHT = "margin-right"
        MARGIN_TOP = "margin-top"
        MASK = "mask"
        MASK_BORDER = "mask-border"
        MASK_BORDER_MODE = "mask-border-mode"
        MASK_BORDER_OUTSET = "mask-border-outset"
        MASK_BORDER_REPEAT = "mask-border-repeat"
        MASK_BORDER_SLICE = "mask-border-slice"
        MASK_BORDER_SOURCE = "mask-border-source"
        MASK_BORDER_WIDTH = "mask-border-width"
        MASK_CLIP = "mask-clip"
        MASK_COMPOSITE = "mask-composite"
        MASK_IMAGE = "mask-image"
        MASK_MODE = "mask-mode"
        MASK_ORIGIN = "mask-origin"
        MASK_POSITION = "mask-position"
        MASK_REPEAT = "mask-repeat"
        MASK_SIZE = "mask-size"
        MASK_TYPE = "mask-type"
        MAX_HEIGHT = "max-height"
        MAX_LINES = "max-lines"
        MAX_WIDTH = "max-width"
        MIN_HEIGHT = "min-height"
        MIN_INLINE_SIZE = "min-inline-size"
        MIN_WIDTH = "min-width"
        MIX_BLEND_MODE = "mix-blend-mode"
        OBJECT_FIT = "object-fit"
        OBJECT_POSITION = "object-position"
        OFFSET = "offset"
        OFFSET_ANCHOR = "offset-anchor"
        OFFSET_DISTANCE = "offset-distance"
        OFFSET_PATH = "offset-path"
        OFFSET_POSITION = "offset-position"
        OFFSET_ROTATE = "offset-rotate"
        OFFSET_ROTATE_ANCHOR = "offset-rotate-anchor"
        OUTLINE = "outline"
        OUTLINE_OFFSET = "outline-offset"
        OVERFLOW = "overflow"
        OVERFLOW_ANCHOR = "overflow-anchor"
        OVERFLOW_BLOCK = "overflow-block"
        OVERFLOW_INLINE = "overflow-inline"
        OVERSCROLL_BEHAVIOR = "overscroll-behavior"
        OVERSCROLL_BEHAVIOR_BLOCK = "overscroll-behavior-block"
        OVERSCROLL_BEHAVIOR_INLINE = "overscroll-behavior-inline"
        OVERSCROLL_BEHAVIOR_X = "overscroll-behavior-x"
        OVERSCROLL_BEHAVIOR_Y = "overscroll-behavior-y"
        PADDING = "padding"
        PADDING_BOTTOM = "padding-bottom"
        PADDING_LEFT = "padding-left"
        PADDING_RIGHT = "padding-right"
        PADDING_TOP = "padding-top"
        PAGE_BREAK_AFTER = "page-break-after"
        PAGE_BREAK_BEFORE = "page-break-before"
        PAGE_BREAK_INSIDE = "page-break-inside"
        POSITION = "position"
        RESIZE = "resize"
        RIGHT = "right"
        SCROLL_BEHAVIOR = "scroll-behavior"
        SCROLL_SNAP_ALIGN = "scroll-snap-align"
        SCROLL_SNAP_STOP = "scroll-snap-stop"
        SCROLL_SNAP_TYPE = "scroll-snap-type"
        SCROLLBAR_COLOR = "scrollbar-color"
        SCROLLBAR_WIDTH = "scrollbar-width"
        SHAPE_IMAGE_THRESHOLD = "shape-image-threshold"
        SHAPE_MARGIN = "shape-margin"
        SHAPE_OUTSIDE = "shape-outside"
        SPEAK = "speak"
        SPEAK_AS = "speak-as"
        TAB_SIZE = "tab-size"
        TABLE_LAYOUT = "table-layout"
        TABLE_LAYOUT = "table-layout"
        TEXT_ALIGN = "text-align"
        TEXT_ALIGN_LAST = "text-align-last"
        TEXT_COMBINE_UPRIGHT = "text-combine-upright"
        TEXT_DECORATION = "text-decoration"
        TEXT_JUSTIFY = "text-justify"
        TEXT_ORIENTATION = "text-orientation"
        TEXT_OVERFLOW = "text-overflow"
        TEXT_RENDERING = "text-rendering"
        TEXT_SHADOW = "text-shadow"
        TEXT_SIZE_ADJUST = "text-size-adjust"
        TEXT_SPACING = "text-spacing"
        TEXT_TRANSFORM = "text-transform"
        TEXT_UNDERLINE_OFFSET = "text-underline-offset"
        TOP = "top"
        TOUCH_ACTION = "touch-action"
        TRANSFORM_BOX = "transform-box"
        TRANSFORM_ORIGIN = "transform-origin"
        TRANSFORM_STYLE = "transform-style"
        TRANSITION = "transition"
        USER_DRAG = "user-drag"
        USER_MODIFY = "user-modify"
        USER_SELECT = "user-select"
        WIDTH = "width"
        WRITING_MODE = "writing-mode"
        Z_INDEX = "z-index"
        
    class MediaTypes:
        PRINT = "print"
        SPEECH = "speech"
        SCREEN = "screen"
        ALL = "all"
        
    class MediaFeatures:
        WIDTH = "width"
        HEIGHT = "height"
        MIN_WIDTH = "min-width"
        MAX_WIDTH = "max-width"
        MIN_HEIGHT = "min-height"
        MAX_HEIGHT = "max-height"
        ORIENTATION = "orientation"
        ASPECT_RATIO = "aspect-ratio"
        COLOR = "color"
        COLOR_INDEX = "color-index"
        RESOLUTION = "resolution"
        SCAN = "scan"
        GRID = "grid"
        UPDATE_FREQUENCY = "update-frequency"
        OVERFLOW_BLOCK = "overflow-block"
        OVERFLOW_INLINE = "overflow-inline"
        POINTER = "pointer"
        HOVER = "hover"
        PREFERS_COLOR_SCHEME = "prefers-color-scheme"


class Stylor:
    def __init__(self):
        self.styles = {}
        self.media_queries = []
        self.current_element = None

    def addStyleCode(self, elements: list, property: SP.CSSProperties, value):
        for element in elements:
            if element not in self.styles:
                self.styles[element] = {}
            if property not in self.styles[element]:
                self.styles[element][property] = []
            self.styles[element][property].append(value)

    def addMedia(self, MediaAttributes):
        self.media_queries.append(MediaAttributes)

    def addNote(self, text: str):
        self.styles.append(f"/* {text} */")

    def finalStyleCode(self, StylesFile=None):
        css_code = ""
        for element, properties in self.styles.items():
            css_code += f"{element} " + "{\n"
            for prop, values in properties.items():
                css_code += f"    {prop}: {' '.join(values)};\n"
            css_code += "}\n"

        css_code += "\n".join(self.media_queries)
        formatted_css = textwrap.dedent(css_code).strip()

        if StylesFile:
            if StylesFile.endswith(".css"):
                with open(StylesFile, "w") as f:
                    f.write(formatted_css)
            else:
                with open(f"{StylesFile}.css", "w") as f:
                    f.write(formatted_css)
                    StylesFile += ".css"

            return [formatted_css, StylesFile]
        else:
            return formatted_css

    class Media:
        def __init__(self, MediaTypes: SP.MediaTypes = None, MediaFeature: SP.MediaFeatures = None, MediaFeatureValue=None):
            if not MediaTypes and not MediaFeature and MediaFeatureValue is None:
                raise ValueError("The class should have at least 1 written argument")

            code = "@media"

            if MediaTypes:
                code += f" {MediaTypes}"
            if MediaFeature and MediaFeatureValue:
                code += f" and ({MediaFeature}: {MediaFeatureValue})"

            if MediaTypes or (MediaFeature and MediaFeatureValue):
                code += " {\n"
            else:
                raise ValueError("Invalid combination of arguments")

            self.code = code
            self.styles = {}
            self.media_queries = {}

        def addStyleCode(self, elements: list, property: SP.CSSProperties, value):
            for element in elements:
                if element not in self.styles:
                    self.styles[element] = {}
                if property not in self.styles[element]:
                    self.styles[element][property] = []
                self.styles[element][property].append(value)

        def addNote(self, text: str):
            self.styles.append(f"/* {text} */")

        def addMedia(self, MediaAttributes):
            self.media_queries.append(MediaAttributes)

        def finalMediaCode(self):
            css_code = ""
            all_medias = "\n".join(self.media_queries) if self.media_queries != [] else ""
            for element, properties in self.styles.items():
                css_code += f"{element} " + "{\n"
                for prop, values in properties.items():
                    css_code += f"    {prop}: {' '.join(values)};\n"
                css_code += "}\n"
            formatted_css = textwrap.dedent(css_code).strip()
            media_code = f"""{self.code}
{formatted_css}
{all_medias}
""" + "}"
            return media_code