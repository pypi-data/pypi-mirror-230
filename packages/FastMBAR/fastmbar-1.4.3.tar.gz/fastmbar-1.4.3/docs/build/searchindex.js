Search.setIndex({"docnames": ["API", "butane_PMF", "dialanine_PMF", "examples", "index", "installation", "references", "usage"], "filenames": ["API.rst", "butane_PMF.rst", "dialanine_PMF.rst", "examples.rst", "index.rst", "installation.rst", "references.rst", "usage.rst"], "titles": ["FastMBAR API", "Example 1. Compute the PMF of a dihedral for butane.", "Example 2. Compute a 2D-PMF of dihedrals for dialanine.", "Examples", "Welcome to FastMBAR!", "Installation", "References", "Usage"], "terms": {"class": [0, 1, 2], "energi": [0, 1, 2, 4, 6, 7], "union": 0, "ndarrai": 0, "tensor": 0, "num_conf": [0, 1, 2, 7], "cuda": [0, 1, 2, 5, 7], "bool": 0, "fals": [0, 1, 2, 5, 7], "cuda_batch_mod": 0, "option": 0, "none": 0, "bootstrap": [0, 7], "bootstrap_block_s": 0, "int": [0, 7], "3": [0, 4, 6], "bootstrap_num_rep": 0, "100": [0, 1, 2, 5], "verbos": [0, 1, 2, 7], "method": [0, 1, 2], "str": 0, "newton": [0, 5], "sourc": [0, 1, 2], "The": [0, 1, 2, 3, 5, 7], "initi": [0, 1, 2, 7], "an": [0, 3, 7], "matrix": [0, 1, 2, 7], "arrai": [0, 1, 2, 7], "num": 0, "conform": [0, 1, 2, 7], "correspond": [0, 1, 2], "mbar": [0, 4], "equat": [0, 4, 6], "solv": [0, 4, 7], "constructor": 0, "therefor": [0, 1, 2, 3, 4, 7], "rel": [0, 1, 2, 4, 7], "free": [0, 1, 2, 4, 6, 7], "state": [0, 1, 2, 4, 6, 7], "us": [0, 3, 5, 6], "calcul": [0, 1, 2, 3, 4, 5, 6, 7], "calculate_free_energies_for_perturbed_st": 0, "can": [0, 1, 2, 3, 4, 5, 7], "perturb": [0, 7], "__init__": 0, "paramet": 0, "2d": [0, 3], "It": [0, 3, 4, 7], "ha": [0, 1, 2, 5, 7], "size": [0, 1, 2, 4], "m": [0, 1, 2, 7], "x": [0, 1, 2, 7], "n": [0, 1, 2, 7], "where": [0, 1, 2, 7], "number": [0, 1, 2, 4, 7], "total": [0, 7], "entri": 0, "i": [0, 1, 2, 5, 7], "j": [0, 2, 6], "reduc": [0, 1, 2, 7], "unitless": [0, 7], "If": [0, 3, 5, 7], "uncertainti": [0, 7], "order": [0, 1, 2, 3, 7], "matter": [0, 3, 7], "sampl": [0, 3, 4, 6, 7], "from": [0, 1, 2, 3, 6, 7], "one": [0, 7], "need": [0, 1, 2, 3, 5, 7], "occpi": 0, "continu": 0, "chunk": 0, "collumn": 0, "k": [0, 1, 2, 7], "occupi": 0, "left": [0, 7], "l": [0, 1, 2, 5, 6, 7], "doe": [0, 1, 2], "1d": 0, "should": [0, 1, 2, 3, 5, 7], "have": [0, 1, 2, 3, 5, 7], "np": [0, 1, 2, 7], "sum": 0, "equal": 0, "all": [0, 1, 2, 3, 7], "strictli": 0, "greater": 0, "than": 0, "0": [0, 1, 2, 5], "default": [0, 1, 2], "set": [0, 1, 2, 7], "true": [0, 1, 2, 5, 7], "run": [0, 3, 5, 7], "graphic": 0, "process": [0, 3], "unit": [0, 1, 2, 7], "gpu": [0, 4, 5, 7], "batch": 0, "mode": 0, "turn": 0, "when": [0, 1, 2, 4], "too": [0, 3, 7], "larg": [0, 4, 6], "memori": [0, 4], "split": [0, 1, 2], "multipl": [0, 1, 2, 4, 6], "which": [0, 1, 2, 5, 7], "ar": [0, 1, 2, 7], "sequenti": [0, 1, 2], "automat": 0, "base": [0, 1, 2, 6, 7], "avaibl": [0, 5], "devic": 0, "estim": [0, 3, 6, 7], "block": 0, "repreat": 0, "detail": [0, 5], "inform": [0, 1, 2, 5], "print": [0, 1, 2, 5, 7], "s": 0, "properti": [0, 1, 2], "f": [0, 1, 2, 7], "under": 0, "constraint": [0, 1, 2], "sum_": [0, 7], "1": [0, 3, 4, 6], "n_k": [0, 7], "f_k": [0, 7], "f_std": [0, 1, 7], "standard": [0, 7], "deviat": [0, 7], "f_cov": 0, "covari": 0, "deltaf": 0, "differ": [0, 1, 2, 6, 7], "between": [0, 1, 2], "mathrm": 0, "e": [0, 1, 2, 7], "deltaf_std": 0, "log_prob_mix": 0, "log": 0, "probabl": [0, 7], "densiti": 0, "mixtur": 0, "distribut": [0, 5, 7], "calculate_free_energies_of_perturbed_st": [0, 1, 2, 7], "energy_perturb": 0, "2": [0, 3, 4, 6], "d": [0, 6], "float": 0, "each": [0, 1, 2, 7], "row": [0, 7], "repres": [0, 1, 2, 7], "valu": 0, "th": [0, 1, 2, 7], "return": [0, 5], "result": [0, 1, 2], "dictionari": 0, "contain": [0, 1, 2], "follow": [0, 1, 2, 3, 5, 6, 7], "kei": 0, "type": [0, 3], "dict": 0, "thi": [1, 2, 5], "includ": [1, 2, 7], "step": [1, 2, 3, 5, 7], "descript": [1, 2, 7], "its": 1, "four": [1, 2], "carbon": 1, "atom": [1, 2], "exhaust": [1, 2], "relev": [1, 2], "configur": [1, 2], "center": [1, 2], "around": [1, 2], "here": [1, 2, 3, 7], "reweigh": [1, 2], "To": [1, 2, 3, 5, 7], "your": [1, 2, 3, 5, 6], "local": [1, 2], "you": [1, 2, 3, 4, 5, 7], "clone": [1, 2], "download": [1, 2, 5], "git": [1, 2], "repositori": [1, 2], "onto": [1, 2], "after": [1, 2, 5, 7], "chang": [1, 2], "current": [1, 2, 5], "work": [1, 2], "directori": [1, 2], "befor": [1, 2, 5], "start": [1, 2, 5], "script": [1, 2], "insid": [1, 2], "python": [1, 2, 4, 7], "interpret": [1, 2], "import": [1, 2, 5, 7], "requir": [1, 2, 4, 7], "packag": [1, 2, 3, 5, 7], "os": [1, 2], "math": [1, 2], "sy": [1, 2], "numpi": [1, 2, 7], "matplotlib": [1, 2], "pyplot": [1, 2], "plt": [1, 2], "app": [1, 2, 5], "omm_app": [1, 2], "omm": [1, 2], "tqdm": [1, 2, 3], "mdtraj": [1, 2, 3], "becaus": [1, 2, 5], "we": [1, 2, 3, 7], "our": [1, 2], "md": [1, 2, 3], "engin": [1, 2, 3], "setup": [1, 2], "molecular": [1, 2, 3, 7], "format": [1, 2], "object": [1, 2, 7], "happen": [1, 2], "call": [1, 2], "prepar": [1, 2], "add": [1, 2], "customtorsionforc": [1, 2], "so": [1, 2, 3], "bias": [1, 2], "potenti": [1, 2, 4, 7], "read": [1, 2, 5, 7], "psf": [1, 2], "pdb": [1, 2], "file": [1, 2], "topolog": [1, 2], "charmm": [1, 2, 3], "gener": [1, 2, 7], "In": [1, 2, 5, 7], "studi": [1, 2, 3], "usual": [1, 2], "alreadi": [1, 2], "variou": [1, 2], "softwar": [1, 2], "gromac": [1, 2, 3], "amber": [1, 2, 3], "among": [1, 2], "other": [1, 2, 3], "just": [1, 2, 3, 4], "note": [1, 2, 7], "sever": [1, 2, 3], "parser": [1, 2], "charmmpsffil": [1, 2], "data": [1, 2, 6], "pdbfile": [1, 2], "forc": [1, 2, 4, 7], "field": [1, 2], "param": 1, "charmmparameterset": [1, 2], "top_all35_eth": 1, "rtf": [1, 2], "par_all35_eth": 1, "prm": [1, 2], "creat": [1, 2, 7], "Then": [1, 2], "harmon": [1, 2], "6": [1, 2], "9": 1, "13": 1, "ad": [1, 2], "veri": [1, 2, 3, 5], "easi": [1, 2, 3, 5], "don": [1, 2], "t": [1, 2], "ani": [1, 2, 3], "code": [1, 2], "do": [1, 2, 5, 7], "tell": [1, 2], "formula": [1, 2], "degre": [1, 2], "freedom": [1, 2], "want": [1, 2, 3, 4, 5, 7], "createsystem": [1, 2], "nonbondedmethod": [1, 2], "nocutoff": [1, 2], "bias_tors": 1, "5": [1, 2, 6], "dtheta": [1, 2], "min": [1, 2], "diff": 1, "pi": [1, 2], "ab": [1, 2], "theta": [1, 2], "theta0": 1, "addglobalparamet": [1, 2], "indic": [1, 2], "carton": 1, "angl": 1, "addtors": [1, 2], "addforc": [1, 2], "save": [1, 2], "xml": [1, 2], "text": [1, 2], "later": [1, 2], "simul": [1, 2, 3, 4, 7], "same": [1, 2], "anoth": [1, 2], "instead": [1, 2], "again": [1, 2], "even": [1, 2], "open": [1, 2, 5], "editor": [1, 2], "see": [1, 2, 3], "what": [1, 2, 3], "about": [1, 2], "output": [1, 2, 5], "w": [1, 2], "file_handl": [1, 2], "write": [1, 2], "xmlserial": [1, 2], "serial": [1, 2], "window": [1, 2], "restrain": [1, 2], "thei": [1, 2, 7], "parallel": [1, 2], "cluster": [1, 2], "node": [1, 2], "r": [1, 2, 6], "deseri": [1, 2], "context": [1, 2], "consist": [1, 2], "integr": [1, 2, 6], "platform": [1, 2, 5], "abov": [1, 2, 5, 7], "specifi": [1, 2], "kind": [1, 2, 3], "langevin": [1, 2], "dynam": [1, 2, 3, 6], "nvt": [1, 2], "ensembl": [1, 2], "langevinmiddleintegr": [1, 2], "hardwar": [1, 2], "choos": [1, 2], "cpu": [1, 2, 4, 5], "quit": [1, 7], "small": 1, "getplatformbynam": [1, 2], "298": [1, 2], "15": [1, 2], "kelvin": [1, 2], "temperatur": [1, 2, 4, 7], "friccoef": [1, 2], "10": [1, 2], "picosecond": [1, 2], "friction": [1, 2], "coeffici": [1, 2], "stepsiz": [1, 2], "femtosecond": [1, 2], "constant": [1, 2], "kj": [1, 2], "mol": [1, 2], "nm": [1, 2], "setparamet": [1, 2], "20": [1, 2], "linspac": [1, 2], "endpoint": [1, 2], "savetxt": 1, "csv": [1, 2], "delimit": 1, "loop": [1, 2], "iter": [1, 2], "first": [1, 2, 7], "minim": [1, 2], "equilibr": [1, 2], "main": [1, 2], "theta0_index": 1, "rang": [1, 2], "index": [1, 2], "out": [1, 2], "setposit": [1, 2], "posit": [1, 2], "getstat": [1, 2], "getenergi": [1, 2], "getpotentialenergi": [1, 2], "50": [1, 2, 5], "localenergyminim": [1, 2], "equilibrium": [1, 2, 6], "5000": [1, 2], "product": [1, 2], "trajectori": [1, 2, 3], "dcd": [1, 2], "traj": [1, 2], "traj_": 1, "bw": [1, 2], "dcd_file": [1, 2], "dcdfile": [1, 2], "dt": [1, 2], "300": 1, "getposit": [1, 2], "writemodel": [1, 2], "close": [1, 2], "For": [1, 2, 5], "them": [1, 2, 3, 7], "load_psf": [1, 2], "load_dcd": [1, 2], "stride": 1, "compute_dihedr": [1, 2], "dihedral_": 1, "fmt": 1, "5f": 1, "two": [1, 2, 7], "firstli": [1, 2], "secondli": [1, 2], "view": [1, 2], "thermodynam": [1, 2, 4, 7], "As": [1, 2, 7], "shown": [1, 2, 7], "usag": [1, 2, 4], "a_": [1, 2, 7], "fig": [1, 2], "u": [1, 2, 5, 7], "function": [1, 2, 7], "b_i": 1, "case": [1, 2, 5, 7], "delta": [1, 2], "0_i": [1, 2], "cartesian": [1, 2], "coordin": [1, 2], "compar": [1, 2], "special": [1, 2], "common": [1, 2], "compon": [1, 2], "remov": [1, 2], "affect": [1, 2], "omit": [1, 2], "loadtxt": 1, "append": [1, 2], "len": 1, "concaten": 1, "A": [1, 2, 6, 7], "zero": [1, 2], "kbt": [1, 2], "boltzmann_constant_kb": [1, 2], "avogadro_constant_na": [1, 2], "value_in_unit": [1, 2], "kilojoule_per_mol": [1, 2], "current_theta0": 1, "minimum": [1, 2], "now": [1, 2], "readi": [1, 2], "yield": [1, 2], "know": [1, 2], "enabl": [1, 2], "procedur": [1, 2], "b_": [1, 2, 7], "theta_": 1, "theta_l": 1, "constrain": [1, 2], "r_l": 1, "enforc": [1, 2], "infin": [1, 2], "otherwis": [1, 2], "b": [1, 2, 5, 6, 7], "25": [1, 2, 5], "theta_pmf": 1, "width": [1, 2], "theta_cent": 1, "theta_low": 1, "theta_high": 1, "inf": [1, 2], "pmf_uncertainti": 1, "plot": [1, 2], "figur": [1, 2, 7], "clf": [1, 2], "errorbar": 1, "180": [1, 2], "yerr": 1, "o": 1, "ecolor": 1, "black": 1, "capsiz": 1, "capthick": 1, "markers": 1, "xlim": 1, "xlabel": [1, 2], "ylabel": [1, 2], "savefig": [1, 2], "pmf_fastmbar": [1, 2], "pdf": [1, 2], "like": [1, 2], "dimension": [2, 4, 7], "charmm_toppar": 2, "top_all36_prot": 2, "par_all36_prot": 2, "psi": 2, "8": [2, 5], "14": 2, "phi": 2, "16": [2, 5], "torsion": 2, "bias_torsion_psi": 2, "k_psi": 2, "tmp": 2, "bias_torsion_phi": 2, "k_phi": 2, "nvp": 2, "idx": 2, "psi_index": 2, "phi_index": 2, "traj_psi_": 2, "_phi_": 2, "alanin": 2, "psi_arrai": 2, "squeez": 2, "stack": 2, "phi_arrai": 2, "b_k": 2, "k_": 2, "0_j": 2, "cam": 2, "shape": 2, "reshap": 2, "psi_c": 2, "phi_c": 2, "psi_diff": 2, "phi_diff": 2, "num_conf_al": 2, "psi_": 2, "psi_i": 2, "psi_j": 2, "phi_": 2, "phi_j": 2, "r_k": 2, "l_pmf": 2, "psi_pmf": 2, "phi_pmf": 2, "psi_c_pmf": 2, "phi_c_pmf": 2, "psi_low": 2, "psi_high": 2, "phi_low": 2, "phi_high": 2, "psi_ind": 2, "phi_ind": 2, "imshow": 2, "flipud": 2, "extent": 2, "colorbar": 2, "besid": 3, "fastmbar": [3, 6], "requri": 3, "comput": [3, 5, 6, 7], "anaconda": [3, 4], "most": 3, "singl": 3, "command": [3, 4, 5, 7], "termin": [3, 5], "openmm": 3, "whenev": 3, "easili": 3, "instruct": [3, 5], "although": 3, "choic": 3, "alwai": 3, "analyz": 3, "load": [3, 5], "intruct": 3, "essenti": 3, "provid": [3, 5, 7], "progress": 3, "bar": 3, "wall": 3, "time": [3, 7], "umbrella": [3, 4, 7], "pip": [3, 4], "pmf": [3, 4, 7], "dihedr": 3, "butan": 3, "dialanin": 3, "solver": [4, 6], "scale": [4, 6], "uwham": 4, "both": [4, 7], "alchem": [4, 6, 7], "mean": [4, 5, 7], "hamiltonian": [4, 7], "replica": [4, 7], "exchang": [4, 7], "extram": 4, "fast": [4, 6], "wham": 4, "moreov": 4, "limit": 4, "find": 4, "especi": 4, "approach": 4, "take": 4, "few": 4, "line": 4, "instal": 4, "new": 4, "test": 4, "api": 4, "exampl": [4, 7], "extra": 4, "packg": 4, "refer": 4, "high": 5, "level": 5, "program": 5, "languag": 5, "highli": 5, "recommend": 5, "manag": 5, "http": 5, "www": 5, "com": 5, "without": 5, "support": 5, "still": 5, "pytorch": 5, "get": [], "specif": 5, "could": 5, "depend": 5, "oper": 5, "system": [5, 7], "version": 5, "check": 5, "nvcc": 5, "error": 5, "messag": 5, "found": 5, "toolkit": 5, "modul": 5, "environ": 5, "contact": 5, "server": 5, "administr": 5, "activ": 5, "c": 5, "torch": 5, "is_avail": 5, "correctli": 5, "pleas": [5, 6], "go": 5, "back": 5, "reinstal": 5, "more": 5, "detal": [], "successfulli": 5, "been": 5, "test_instal": [], "similar": 5, "rmsd": [], "05": [], "pass": 5, "With": 7, "consid": 6, "cite": 6, "project": 6, "xinqiang": 6, "ding": 6, "jonah": 6, "z": 6, "vilseck": 6, "charl": 6, "brook": 6, "iii": 6, "2019": 6, "multist": 6, "bennett": 6, "accept": 6, "ratio": 6, "chem": 6, "theori": 6, "ryan": 6, "hay": 6, "2017": 6, "gibb": 6, "sampler": 6, "\u03bb": 6, "rao": 6, "blackwel": 6, "shirt": 6, "michael": 6, "john": 6, "chodera": 6, "2008": 6, "statist": 6, "optim": 6, "analysi": 6, "phy": 6, "h": 6, "1976": 6, "effici": 6, "mont": [6, 7], "carlo": [6, 7], "help": 7, "better": 7, "undertand": 7, "might": 7, "thu": 7, "abstract": 7, "firt": 7, "user": 7, "recommand": 7, "understand": 7, "question": 7, "chemistri": 7, "let": 7, "assum": 7, "u_k": 7, "boltzmann": 7, "p_k": 7, "propto": 7, "exp": 7, "right": 7, "invers": 7, "beta": 7, "k_bt": 7, "origin": 7, "e_k": 7, "defin": 7, "quantiti": 7, "ln": 7, "dx": 7, "also": 7, "convert": 7, "mutipli": 7, "There": 7, "mani": 7, "wai": 7, "separ": 7, "either": 7, "dynamci": 7, "reweight": 7, "_k": 7, "second": 7, "prime": 7, "_l": 7, "situat": 7, "describ": 7, "input": 7, "vector": 7, "v": [5, 7], "conduct": 7, "blue": 7, "bracket": 7, "column": 7, "evalu": 7, "These": 7, "constitu": 7, "construct": 7, "n_1": 7, "n_2": 7, "n_m": 7, "calcuat": 7, "store": 7, "respect": 7, "seper": 7, "previou": 7, "red": 7, "term": 7, "enegi": 7, "f_perturb": 7, "f_perturbed_std": 7, "_": [], "pytest": 5, "pyarg": 5, "session": 5, "linux": 5, "11": 5, "4": [5, 6], "7": 5, "pluggi": 5, "home": 5, "xqding": 5, "miniconda3": 5, "env": 5, "bin": 5, "python3": 5, "cachedir": 5, "pytest_cach": 5, "rootdir": 5, "collect": 5, "12": 5, "item": 5, "lib": [], "site": [], "test_fastmbar": 5, "py": 5, "test_fastmbar_cpu": 5, "bfg": 5, "33": 5, "test_fastmbar_gpu": 5, "41": 5, "58": 5, "66": 5, "75": 5, "83": 5, "91": 5, "111": 5, "64": 5, "01": 5, "51": 5, "skip": 5, "29": 5, "67": 5, "kong": 6, "mccullagh": 6, "p": 6, "meng": 6, "xl": 6, "nicola": 6, "tan": 6, "2003": 6, "model": 6, "stat": 6, "soc": 6, "ser": 6, "methodol": 6}, "objects": {"FastMBAR": [[0, 0, 1, "", "FastMBAR"]], "FastMBAR.FastMBAR": [[0, 1, 1, "", "DeltaF"], [0, 1, 1, "", "DeltaF_std"], [0, 1, 1, "", "F"], [0, 1, 1, "", "F_cov"], [0, 1, 1, "", "F_std"], [0, 2, 1, "", "__init__"], [0, 2, 1, "", "calculate_free_energies_of_perturbed_states"], [0, 1, 1, "", "log_prob_mix"]]}, "objtypes": {"0": "py:class", "1": "py:property", "2": "py:method"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "property", "Python property"], "2": ["py", "method", "Python method"]}, "titleterms": {"fastmbar": [0, 1, 2, 4, 5, 7], "api": 0, "exampl": [1, 2, 3], "1": [1, 2, 5, 7], "comput": [1, 2], "pmf": [1, 2], "dihedr": [1, 2], "butan": 1, "construct": [1, 2], "an": [1, 2], "openmm": [1, 2], "system": [1, 2], "2": [1, 2, 5, 7], "run": [1, 2], "umbrella": [1, 2], "sampl": [1, 2], "3": [1, 2, 5], "collect": [1, 2], "valu": [1, 2], "4": [1, 2], "us": [1, 2, 4, 7], "solv": [1, 2], "mbar": [1, 2, 7], "uwham": [1, 2], "equat": [1, 2, 7], "2d": 2, "dialanin": 2, "both": 2, "instal": [3, 5], "extra": 3, "requir": 3, "python": [3, 5], "packg": 3, "welcom": 4, "what": 4, "why": 4, "how": [4, 7], "new": 5, "anaconda": 5, "pip": 5, "test": 5, "refer": 6, "usag": 7, "when": 7}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx": 56}})